# 执行 - 多模型协作执行 (Multi-Model Collaborative Execution)

多模型协作执行 - 从方案获取原型 → Claude 重构并实现 → 多模型审计与交付。

$ARGUMENTS

---

## 核心协议

- **语言协议**：与工具/模型交互时使用 **英语**，与用户交流时使用用户的语言
- **代码主权**：外部模型 **没有文件系统写权限**，所有修改由 Claude 执行
- **重构原始原型**：将 Codex/Gemini 的输出视为“原始原型”，必须将其重构为生产级代码
- **止损机制**：在当前阶段输出通过验证前，不要进入下一阶段
- **前提条件**：仅在用户对 `/ccg:plan` 的输出明确回复 "Y" 后执行

---

## 执行工作流

**执行任务**：$ARGUMENTS

### 第 0 阶段：读取方案 (Read Plan)

`[模式: Prepare]`

1. **识别输入类型**：方案文件路径或直接的任务描述
2. **读取方案内容**：提取任务类型、实施步骤、关键文件、SESSION_ID
3. **任务路由**：
   - **前端**：由 Gemini 处理
   - **后端**：由 Codex 处理
   - **全栈**：Codex 与 Gemini 并行处理

### 第 1 阶段：快速上下文检索 (Retrieval)

`[模式: Retrieval]`

根据方案中的“关键文件”列表，使用检索工具获取代码。

### 第 3 阶段：获取原型 (Prototype)

`[模式: Prototype]`

根据任务类型路由：
- **前端/UI/样式 → Gemini**：CSS/React/Vue 原型是最终的视觉基准
- **后端/逻辑/算法 → Codex**：利用其逻辑推理和调试能力获取逻辑原型

### 第 4 阶段：代码实现 (Implement)

`[模式: Implement]`

**Claude 作为代码主权执行者执行以下步骤**：
1. **解析 Diff**：解析模型返回的 Unified Diff
2. **重构与清理**：将“原始原型”重构为**高可读、易维护、企业级**的代码
3. **遵循标准**：遵循项目现有的代码标准
4. **最小化范围**：修改仅限于需求范围，避免副作用

### 第 5 阶段：审计与交付 (Audit)

`[模式: Audit]`

1. **自动审计**：修改生效后，立即并行调用 Codex 和 Gemini 进行代码评审
2. **整合与修复**：综合评审反馈，后端参考 Codex，前端参考 Gemini，执行必要的修复
3. **交付确认**：审计通过后，向用户报告更改摘要和后续建议
