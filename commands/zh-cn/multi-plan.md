# 规划 - 多模型协作规划 (Multi-Model Collaborative Planning)

多模型协作规划 - 上下文检索 + 双模型分析 → 生成分步实施方案。

$ARGUMENTS

---

## 核心协议

- **语言协议**：与工具/模型交互时使用 **英语**，与用户交流时使用用户的语言
- **强制并行**：Codex/Gemini 的调用必须使用并行模式，以避免阻塞
- **代码主权**：外部模型 **没有文件系统写权限**，所有修改由 Claude 执行
- **仅限规划**：此命令仅允许读取上下文和写入方案文件，**严禁修改生产代码**

---

## 执行工作流

**规划任务**：$ARGUMENTS

### 第 1 阶段：完整上下文检索 (Research)

`[模式: Research]`

1. **需求增强**：使用增强工具细化原始需求
2. **上下文检索**：检索相关的类、函数、变量定义
3. **完整性检查**：确保获取了完整的定义和签名，不基于假设回答

### 第 2 阶段：多模型协作分析 (Analysis)

`[模式: Analysis]`

1. **并行调用分析**：
   - **Codex 后端分析**：侧重技术可行性、架构影响、性能风险
   - **Gemini 前端分析**：侧重 UI/UX 影响、用户体验、视觉设计
2. **交叉验证**：整合视角，识别共识，权衡分歧。后端逻辑听取 Codex，前端设计听取 Gemini

### 第 3 阶段：生成实施方案 (Claude 最终版)

综合双模型分析结果，生成**分步实施方案**，包含：
- 任务类型 (前端/后端/全栈)
- 技术方案
- 实施步骤
- 关键文件列表
- 风险与对策

### 阶段结束：方案交付 (而非执行)

1. 向用户展示完整的实施方案 (包含伪代码)
2. 将方案保存到 `.claude/plan/<feature-name>.md`
3. 提示用户进行评审或执行：
   - **修改方案**：告诉需要调整的地方，我将更新方案
   - **执行方案**：在新的会话中运行 `/ccg:execute <方案路径>`

**绝对禁止**：
- 在未经确认的情况下自动执行代码修改
- 在 `/ccg:plan` 阶段进行任何生产代码的写入操作
